<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Übung: Kanton als JSON laden und im Browserfenster anzeigen - Lösung</title>
  </head>
  <body style="background: #e2fead;">
    <h1>Übung: Kanton als JSON laden und im Browserfenster anzeigen - Lösung</h1>
    <div id="container">
      <div id="buttons">
        <button class="btn" data-dateiname="linie1a">1 Lachen – Bahnhofplatz – Plankis – Domat/Ems – Rhäzüns</button><br>
        <button class="btn" data-dateiname="linie1b">1 Lachen – Bahnhofplatz – Plankis – Felsberg</button><br>
        <button class="btn" data-dateiname="linie2a">2 Obere Au – Bahnhofplatz – Fürstenwald</button><br>
        <button class="btn" data-dateiname="linie2b">2 Obere Au – Bahnhofplatz – Kleinwaldegg</button><br>
        <button class="btn" data-dateiname="linie3a">3 Austrasse – Bahnhofplatz – Stelleweg – Haldenstein</button><br>
        <button class="btn" data-dateiname="linie3b">3 Austrasse – Bahnhofplatz – Trimmis – Untervaz</button><br>
        <button class="btn" data-dateiname="linie4">4 Austrasse – Bahnhofplatz – Seniorenzentrum Cadonau</button><br>
        <button class="btn" data-dateiname="linie6">6 Bahnhofplatz – City West</button><br>
        <button class="btn" data-dateiname="linie9">9 Bahnhofplatz – Meiersboden</button><br>
      </div>
      <div id="anzeige">

      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function(event) {

        let buttons = document.querySelectorAll('.btn');
        for(let i = 0; i < buttons.length; i++){
          buttons[i].addEventListener("click", function(){
  // !!!!!!
            laden_und_anzeigen(this.getAttribute("data-dateiname"));

          })
        }

        function laden_und_anzeigen(dateiname){
          let  url = "extern/" + dateiname + ".json";
          fetch(url)
            .then((response) => {
              // Definieren, welches Format die Antwort hat (wichtig für den nächsten Teil)
              // !!!!! hier JSON !!!!!!
              return response.json();
            })
            .then((data) => {
              bus_anzeigen(data);
            })
            .catch(function(error) {
              console.log('Error: ' + error.message);
            });
        }

        function bus_anzeigen(bus_parameter){

          let bus_anzeige = document.createElement('div');
          let liniennummer_anzeige = document.createElement('h2');
          liniennummer_anzeige.textContent = bus_parameter.liniennummer;

          let kurzbeschreibung_anzeige = document.createElement('h3');
          kurzbeschreibung_anzeige.textContent = bus_parameter.kurzbeschreibung;

          let haltestellen_liste = document.createElement('ul');
          for(let i = 0; i < bus_parameter.haltestellen.length; i++){
            let haltestelle = document.createElement('li');
            haltestelle.textContent = bus_parameter.haltestellen[i];
            haltestellen_liste.appendChild(haltestelle);
          }

          let html_container = document.querySelector('#anzeige');
          html_container.innerHTML = "";
          html_container.appendChild(liniennummer_anzeige);
          html_container.appendChild(kurzbeschreibung_anzeige);
          html_container.appendChild(haltestellen_liste);
        }
      });
    </script>
  </body>
</html>
